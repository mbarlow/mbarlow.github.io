<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Indicator Animation Test</title>
    <style>
        body { background: #222; color: white; font-family: monospace; padding: 20px; }
        button { margin: 5px; padding: 10px; }
        #log { margin-top: 20px; white-space: pre-wrap; }
    </style>
</head>
<body>
    <h1>Indicator Animation Test</h1>
    <div>
        <button onclick="testThinking()">Test Thinking Animation</button>
        <button onclick="testNotification()">Test Notification</button>
        <button onclick="testError()">Test Error</button>
        <button onclick="testSuccess()">Test Success</button>
    </div>
    <div id="log"></div>
    
    <script type="module">
        import { app } from '/src/js/app.js';
        
        window.testThinking = () => {
            const log = document.getElementById('log');
            log.textContent += '\n\nTesting thinking animation...';
            
            // Get origin entity
            const world = app.threeDSystem?.world;
            if (!world) {
                log.textContent += '\nError: World not found';
                return;
            }
            
            const entities = world.getEntities();
            const originEntity = entities.find(e => e.getComponent('BrainComponent'));
            
            if (originEntity) {
                const indicator = originEntity.getComponent('IndicatorComponent');
                if (indicator) {
                    log.textContent += '\nFound indicator, setting thinking state...';
                    indicator.setState('thinking');
                    
                    // Check animation status
                    setTimeout(() => {
                        log.textContent += '\nAnimation info: ' + JSON.stringify(indicator.getInfo());
                        log.textContent += '\nAnimation active: ' + indicator.animationManager.hasActiveAnimation();
                    }, 100);
                } else {
                    log.textContent += '\nError: No indicator on origin entity';
                }
            } else {
                log.textContent += '\nError: Origin entity not found';
            }
        };
        
        window.testNotification = () => {
            const log = document.getElementById('log');
            log.textContent += '\n\nTesting notification animation...';
            
            const world = app.threeDSystem?.world;
            if (!world) return;
            
            const entities = world.getEntities();
            const originEntity = entities.find(e => e.getComponent('BrainComponent'));
            
            if (originEntity) {
                const indicator = originEntity.getComponent('IndicatorComponent');
                if (indicator) {
                    indicator.setState('notification');
                }
            }
        };
        
        window.testError = () => {
            const log = document.getElementById('log');
            log.textContent += '\n\nTesting error animation...';
            
            const world = app.threeDSystem?.world;
            if (!world) return;
            
            const entities = world.getEntities();
            const originEntity = entities.find(e => e.getComponent('BrainComponent'));
            
            if (originEntity) {
                const indicator = originEntity.getComponent('IndicatorComponent');
                if (indicator) {
                    indicator.setState('error');
                }
            }
        };
        
        window.testSuccess = () => {
            const log = document.getElementById('log');
            log.textContent += '\n\nTesting success animation...';
            
            const world = app.threeDSystem?.world;
            if (!world) return;
            
            const entities = world.getEntities();
            const originEntity = entities.find(e => e.getComponent('BrainComponent'));
            
            if (originEntity) {
                const indicator = originEntity.getComponent('IndicatorComponent');
                if (indicator) {
                    indicator.setState('success');
                }
            }
        };
    </script>
</body>
</html>